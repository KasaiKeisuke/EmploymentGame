//*******************************************************************************************************************************************
//
// ダイナマイトアリーナ(PlayerParam.cpp)
// Author : Kasai Keisuke
//
//*******************************************************************************************************************************************

// include
#include "PlayerParam.h"

//*******************************************************************************************************************************************
// コンストラクタ
//*******************************************************************************************************************************************
CParamManager::CParamManager()
{
	m_fSpeed = 0.0f;	// プレイヤーの移動速度
	m_nPower = 0;		// 爆弾の爆発力
	m_nCnt = 0;			// パラメーターの強化時間
}

//*******************************************************************************************************************************************
// デストラクタ
//*******************************************************************************************************************************************
CParamManager::~CParamManager()
{
	m_fSpeed = 0.0f;	// プレイヤーの移動速度
	m_nPower = 0;		// 爆弾の爆発力
	m_nCnt = 0;			// パラメーターの強化時間
}

//*******************************************************************************************************************************************
// 初期化処理
//*******************************************************************************************************************************************
HRESULT CParamManager::Init()
{
	m_nPower = 2;		// 爆弾の爆発力(前後左右各方向)
	m_fSpeed = 1.3f;	// プレイヤーの移動速度
	m_nCnt = 180;		// パラメーター強化時間
	return S_OK;
}

//*******************************************************************************************************************************************
// 終了処理
//*******************************************************************************************************************************************
void CParamManager::Uninit()
{
	m_nPower = 2;	// 爆弾の爆発力
	m_fSpeed = 1.3f;	// プレイヤーの移動速度
	m_nCnt = 180;		// パラメーター強化時間
}

//*******************************************************************************************************************************************
// 更新処理
//*******************************************************************************************************************************************
void CParamManager::Update()
{
	if (m_nCnt > 0)
	{
		m_nCnt--; // 強化時間を減少
		if (m_nCnt == 0)
		{
			// 強化が終了したらパラメーターをリセット
			ResetParam();
		}
	}
}

//*******************************************************************************************************************************************
// プレイヤーの移動速度設定処理
//*******************************************************************************************************************************************
void CParamManager::SetSpeed(float fSpeed)
{
	m_fSpeed = fSpeed;
}

//*******************************************************************************************************************************************
// プレイヤーの移動速度取得処理
//*******************************************************************************************************************************************
float CParamManager::GetSpeed()
{
	return m_fSpeed;
}

//*******************************************************************************************************************************************
// 爆弾の爆発力設定処理
//*******************************************************************************************************************************************
void CParamManager::SetPower(int nPower)
{
	m_nPower = nPower;
}

//*******************************************************************************************************************************************
// 爆弾の爆発力取得処理
//*******************************************************************************************************************************************
int CParamManager::GetPower()
{
	return m_nPower;
}

//*******************************************************************************************************************************************
// パラメーター強化時間取得処理
//*******************************************************************************************************************************************
int CParamManager::GetTime()
{
	return m_nCnt;
}

//*******************************************************************************************************************************************
// パラメーター強化処理
//*******************************************************************************************************************************************
void CParamManager::AddParam(int nCnt, int nType)
{
	m_nCnt = nCnt; // 強化時間を設定

	int nCurrentPower = GetPower();
	float fCurrentSpeed = GetSpeed();
	switch (nType)
	{
	case 1:
		nCurrentPower += 1; // 爆発力を1増加
		break;
	case 2:
		fCurrentSpeed += 1.0f; // 移動速度を0.5増加
		break;
	}

	SetPower(nCurrentPower);
	SetSpeed(fCurrentSpeed);
}

//*******************************************************************************************************************************************
// パラメーターリセット処理
//*******************************************************************************************************************************************
void CParamManager::ResetParam()
{
	m_nPower = 2;   // 初期値に戻す
	m_fSpeed = 1.3f; // 初期値に戻す
}
